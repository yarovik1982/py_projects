<!DOCTYPE html>
<html lang="ru">

<head>
   <meta charset="UTF-8" />
   <meta name="viewport" content="width=device-width, initial-scale=1.0" />
   <title>Когда вернется Наташа?</title>

   <style>
      * {
         box-sizing: border-box;
         margin: 0;
         padding: 0;
         font-family: Arial, Helvetica, sans-serif;
      }

      body {
         min-height: 100vh;
         display: flex;
         justify-content: center;
         align-items: center;
         background: #0f172a;
         color: #fff;
         overflow: hidden;
      }

      .wrapper {
         text-align: center;
         z-index: 1;
      }

      button {
         padding: 14px 26px;
         font-size: 18px;
         border: none;
         border-radius: 12px;
         background: #ec4899;
         color: #fff;
         cursor: pointer;
         transition: transform .2s, background .3s;
         margin: 6px;
      }

      button:hover {
         background: #db2777;
         transform: scale(1.05);
      }

      .timer {
         display: none;
         margin-top: 20px;
      }

      .timer h1 {
         font-size: 28px;
         margin-bottom: 16px;
         font-weight: 500;
      }

      .time {
         font-size: 34px;
         font-weight: bold;
      }

      canvas {
         position: fixed;
         inset: 0;
         pointer-events: none;
         z-index: 0;
      }
   </style>
</head>

<body>
   <div class="wrapper">
      <button id="showTimer">Когда вернется Наташа?</button>

      <div class="timer" id="timer">
         <h1 id="title"></h1>
         <div class="time" id="time"></div>
         <button id="stopTimer" style="display:none;">Остановить таймер</button>
      </div>
   </div>

   <canvas id="hearts"></canvas>

   <script>
      const button = document.getElementById("showTimer");
      const stopBtn = document.getElementById("stopTimer");
      const timerBlock = document.getElementById("timer");
      const titleEl = document.getElementById("title");
      const timeEl = document.getElementById("time");

      const targetDate = new Date(
         new Date().getFullYear(),
         1, // февраль
         20,
         0, 0, 0
      );

      let timerInterval = null;
      let timerStopped = false;

      button.addEventListener("click", () => {
         button.style.display = "none";

         const diff = targetDate - Date.now();

         if (diff > 0) {
            titleEl.textContent = "До возвращения Наташи осталось";
            timerBlock.style.display = "block";
            stopBtn.style.display = "inline-block";

            updateTimer();
            timerInterval = setInterval(updateTimer, 60 * 1000);
         } else {
            showReturned();
         }
      });

      stopBtn.addEventListener("click", () => {
         timerStopped = true;
         clearInterval(timerInterval);
         showReturned();
      });

      function declension(n, forms) {
         n = Math.abs(n) % 100;
         const n1 = n % 10;
         if (n > 10 && n < 20) return forms[2];
         if (n1 > 1 && n1 < 5) return forms[1];
         if (n1 === 1) return forms[0];
         return forms[2];
      }

      function updateTimer() {
         if (timerStopped) return;

         const diff = targetDate - Date.now();

         if (diff <= 0) {
            clearInterval(timerInterval);
            showReturned();
            return;
         }

         const totalMinutes = Math.floor(diff / 1000 / 60);
         const days = Math.floor(totalMinutes / (60 * 24));
         const hours = Math.floor((totalMinutes % (60 * 24)) / 60);
         const minutes = totalMinutes % 60;

         timeEl.textContent =
            `${days} ${declension(days, ["день", "дня", "дней"])} ` +
            `${hours} ${declension(hours, ["час", "часа", "часов"])} ` +
            `${minutes} ${declension(minutes, ["минута", "минуты", "минут"])}`;
      }

      function showReturned() {
         clearInterval(timerInterval);
         stopBtn.style.display = "none";
         timerBlock.style.display = "block";
         titleEl.textContent = "Наташа уже вернулась ❤️";
         timeEl.textContent = "";
         startHearts();
      }

      // ❤️ АНИМАЦИЯ СЕРДЕЧЕК
      function startHearts() {
         const canvas = document.getElementById("hearts");
         const ctx = canvas.getContext("2d");

         canvas.width = window.innerWidth;
         canvas.height = window.innerHeight;

         const colors = [
            "#ec4899", "#ef4444", "#f97316",
            "#facc15", "#a855f7", "#22c55e", "#38bdf8"
         ];

         const hearts = Array.from({ length: 140 }, () => ({
            x: Math.random() * canvas.width,
            y: Math.random() * canvas.height - canvas.height,
            size: Math.random() * 10 + 10,
            speed: Math.random() * 2 + 1,
            opacity: Math.random() * 0.4 + 0.6,
            color: colors[Math.floor(Math.random() * colors.length)]
         }));

         function drawHeart(x, y, size, opacity, color) {
            ctx.globalAlpha = opacity;
            ctx.fillStyle = color;
            ctx.beginPath();
            ctx.moveTo(x, y);
            ctx.bezierCurveTo(
               x - size, y - size,
               x - size * 2, y + size / 2,
               x, y + size * 2
            );
            ctx.bezierCurveTo(
               x + size * 2, y + size / 2,
               x + size, y - size,
               x, y
            );
            ctx.fill();
            ctx.globalAlpha = 1;
         }

         function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            hearts.forEach(h => {
               h.y += h.speed;
               if (h.y > canvas.height + 20) {
                  h.y = -20;
                  h.x = Math.random() * canvas.width;
               }
               drawHeart(h.x, h.y, h.size, h.opacity, h.color);
            });

            requestAnimationFrame(animate);
         }

         animate();
      }
   </script>
</body>

</html>